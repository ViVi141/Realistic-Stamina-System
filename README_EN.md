# Realistic Stamina System (RSS)

[中文 README](README_CN.md) | [English README (current)](README_EN.md) | [Mixed README](README.md)

[![License: AGPL-3.0](https://img.shields.io/badge/License-AGPL--3.0-blue.svg)](https://www.gnu.org/licenses/agpl-3.0)
[![Arma Reforger](https://img.shields.io/badge/Arma-Reforger-orange)](https://www.bohemia.net/games/arma-reforger)

**Realistic Stamina System (RSS)** is a realistic stamina & speed mod for Arma Reforger.  
It dynamically adjusts movement speed based on stamina, encumbrance, slope, environment, and more—using medical/physiological models (e.g. Pandolf energy expenditure).

## Authors

- **Author**: ViVi141
- **Email**: 747384120@qq.com
- **License**: [AGPL-3.0](LICENSE)

## Highlights

- **Dual-state “stress/performance” model**: performance plateau at high stamina, smooth degradation near exhaustion.
- **Wall-hit smoothing**: damping transition around the critical stamina threshold.
- **Slope-adaptive movement**: slope-aware pacing and energy cost.
- **Encumbrance system**: load affects “fuel economy” (stamina drain) more than hard speed caps.
- **Movement types**: Idle / Walk / Run / Sprint.
- **Environmental stress**: heat stress + rain wet weight.
- **Swimming stamina management**: 3D physical model (drag + vertical work + treading).
- **EPOC delay**: post-exercise oxygen consumption delay logic.
- **Debug/status output**: 1s status + 5s detailed debug info (client-side).
- **Modular architecture**: stamina update coordination, swimming state, debug display, etc.

For the full, detailed (and frequently updated) explanation, see:
- **Changelog**: `CHANGELOG.md`
- **Chinese full README**: `README_CN.md`

## Trend Plots (Bilingual)

These plots are generated by scripts in `tools/` and use **bilingual (ZH/EN) labels** (title/axes/legend).

### 1) Basic Trends

![stamina_system_trends](stamina_system_trends.png)

### 2) Comprehensive Trends

Generated by `generate_comprehensive_trends.py`, split into multiple independent charts:

#### 2.1) 2-mile Test
![comprehensive_2mile_test](comprehensive_2mile_test.png)

#### 2.2) Load Comparison
![comprehensive_load_comparison](comprehensive_load_comparison.png)

#### 2.3) Movement Type Speed
![comprehensive_movement_type_speed](comprehensive_movement_type_speed.png)

#### 2.4) Recovery Analysis
![comprehensive_recovery_analysis](comprehensive_recovery_analysis.png)

#### 2.5) 2-mile Speed Profile
![comprehensive_2mile_speed](comprehensive_2mile_speed.png)

#### 2.6) Load vs Speed Penalty
![comprehensive_load_speed_penalty](comprehensive_load_speed_penalty.png)

#### 2.7) Multi-factor Comparison
![comprehensive_multi_factor_comparison](comprehensive_multi_factor_comparison.png)

### 3) Multi-dimensional Analysis

Generated by `multi_dimensional_analysis.py`, split into multiple independent charts:

#### 3.1) 2-mile Test by Load
![multi_2mile_by_load](multi_2mile_by_load.png)

#### 3.2) Speed by Movement Type
![multi_speed_by_movement_type](multi_speed_by_movement_type.png)

#### 3.3) Drain by Slope
![multi_drain_by_slope](multi_drain_by_slope.png)

#### 3.4) Speed (Types & Slopes)
![multi_speed_types_slopes](multi_speed_types_slopes.png)

#### 3.5) Drain (Types & Slopes)
![multi_drain_types_slopes](multi_drain_types_slopes.png)

#### 3.6) 2-mile by Movement Type
![multi_2mile_by_movement_type](multi_2mile_by_movement_type.png)

#### 3.7) 2-mile by Slope
![multi_2mile_by_slope](multi_2mile_by_slope.png)

#### 3.8) Speed vs Drain Rate
![multi_speed_vs_drain](multi_speed_vs_drain.png)

## Project Structure (High-level)

Key paths (see `README_CN.md` for the full tree):

- `scripts/Game/PlayerBase.c`: main controller (speed update + status display)
- `scripts/Game/Components/Stamina/`: modular stamina system
  - `SCR_RealisticStaminaSystem.c`: core math/models
  - `SCR_StaminaUpdateCoordinator.c`: orchestration for speed/drain/recovery
  - `SCR_SwimmingState.c`: swimming detection + wet weight tracking
  - `SCR_DebugDisplay.c`: debug/status formatting & output
  - plus other modules (terrain, EPOC, fatigue, encumbrance cache, UI bridge, etc.)
- `tools/`: python analysis/plot generators

## Installation

1. Copy the entire addon folder into Arma Reforger Workbench `addons/`
2. Open the project in Workbench
3. Build/compile
4. Enable the mod in-game

## Tools (Python)

The `tools/` directory provides reproducible plots/analysis:

- `tools/simulate_stamina_system.py` → `stamina_system_trends.png`
- `tools/generate_comprehensive_trends.py` → 7 independent charts (comprehensive_*.png)
- `tools/multi_dimensional_analysis.py` → 8 independent charts (multi_*.png)

Notes:
- Scripts are **headless-friendly** (no GUI popups by default).
- Dependencies: Python + `numpy` + `matplotlib`.
- Charts are split into independent files for better readability.

## Contributing

See `CONTRIBUTING.md`.

## License

This project is licensed under **GNU AGPL-3.0**. See `LICENSE`.
