# 待办事项列表 (TODO List)

本文件记录了 Arma Reforger 拟真体力-速度系统的待办事项。

---

## 🔬 未来功能扩展

### 🟢 低优先级

#### 1. 鞋具/足部重量因子 (Footwear Factor)

**状态**: 待开始  
**优先级**: 🟢 低（Arma Reforger 对鞋子细分支持有限）

**概念**: 
- 特种部队常言："足部一斤，背上一五"（1kg on feet = 5kg on back）
- 足部负重对身体消耗的影响是背部负重的 5 倍

**解决方案**:
- 轻便运动鞋：`k_shoe = 1.0`（基准）
- 重型作战靴：`k_shoe = 1.2`（+20% 消耗）
- 泥泞环境：增加"泥泞系数"，给总重量 `M` 增加微小加成

**实现难度**: ⭐⭐ (中等，需要环境状态跟踪)  
**预期代码量**: 30-50 行  
**文件位置**: `scripts/Game/Components/Stamina/SCR_RealisticStaminaSystem.c`

**注意**: 由于 Arma Reforger 对鞋子细分支持有限，此项可以简化为环境系数。

---

#### 2. 装备重心与人体工学（Load Distribution）🎒

**状态**: 待开始  
**优先级**: 🟢 低（复杂功能）

**问题**: 
- 同样的 30kg，背在背上（Backpack）和挂在胸口（Chest Rig）对移动的影响不同
- **防弹衣（Vest）**：限制胸腔扩张，增加呼吸功
- **背包（Backpack）**：改变重心，影响斜坡上的平衡（增加坡度惩罚）

**解决方案**:
- 计算负重时，给不同槽位的物品分配不同的"惩罚权重"
- 例如：胸挂物品对体力消耗影响更大，背包物品对速度影响更大

**实现难度**: ⭐⭐⭐ (高，需要槽位系统)  
**预期代码量**: 100-150 行  
**文件位置**: `scripts/Game/Components/Stamina/SCR_RealisticStaminaSystem.c`

---

#### 3. 真正的"伤病"交互（Injury Integration）🩸

**状态**: 待开始  
**优先级**: 🟡 中

**问题**: 
- **失血（Bleeding）**：失血会导致循环系统携氧能力下降
- 当前系统未考虑伤病对体力系统的影响

**解决方案**:
- `NewStaminaEfficiency = BaseEfficiency * (1.0 - BloodLossPercent)`
- 这意味着失血严重的士兵，即使体力槽满了，也会比健康士兵更容易累
- 需要与游戏的伤害系统集成

**实现难度**: ⭐⭐⭐ (高，需要伤害系统 API)  
**预期代码量**: 60-100 行  
**文件位置**: `scripts/Game/PlayerBase.c`

---

#### 4. 跳跃检测改进（从输入检测改为动作检测）🦘

**状态**: 待开始  
**优先级**: 🟢 低

**问题**: 
- 当前跳跃检测基于按键输入（`OnJumpActionTriggered`、`OnPrepareControls`），而非实际动作
- 这意味着即使角色未能成功跳跃（例如被障碍物阻挡、体力不足无法跳跃），系统也会扣除体力
- 检测的是"输入意图"而不是"实际发生的动作"

**解决方案**:
- 改为检测实际的物理动作（例如垂直速度变化、动画状态等）
- 可以结合 `GetVelocity()` 的垂直分量来检测实际的上升动作
- 或者通过动画组件检测跳跃动画状态
- 确保只有在角色真正离开地面时才扣除体力

**实现难度**: ⭐⭐ (中等，需要物理动作检测)  
**预期代码量**: 30-50 行  
**文件位置**: `scripts/Game/PlayerBase.c`（修改跳跃检测逻辑）

---

## 📊 统计数据

- **总任务数**: 4 个
- **待开始**: 4 个

**按优先级分类**:
- 🟡 中优先级: 1 个（伤病交互）
- 🟢 低优先级: 3 个（鞋具因子、装备重心、跳跃检测改进）

**按难度分类**:
- ⭐⭐ 中等难度: 2 个（鞋具因子、跳跃检测改进）
- ⭐⭐⭐ 高难度: 2 个（装备重心、伤病交互）

---

## 📚 参考资源

### 学术论文
1. **Pandolf, K. B., et al. (1977)** - 基础 Pandolf 能量消耗模型
2. **Santee, W. R., et al. (2001)** - 下坡修正模型
3. **Givoni, B., & Goldman, R. F. (1971)** - 跑步能量消耗模型
4. **Palumbo, M. C., et al. (2018)** - 个性化运动建模

### 军事标准
- **ACFT (Army Combat Fitness Test)** - 美国陆军战斗体能测试标准
- **Knapik, J. J., et al. (1996)** - US Army 背包负重实验数据

---

**最后更新**: 2026-01-20  
**维护者**: ViVi141
