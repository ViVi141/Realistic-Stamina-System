# 体力系统计算逻辑文档

## 目录
- [一、系统架构](#一系统架构)
- [二、决策树](#二决策树)
- [三、核心公式](#三核心公式)
- [四、数值分类](#四数值分类)
- [4.1 硬编码常量](#41-硬编码常量)
- [4.2 动态配置值](#42-动态配置值)


---

## 一、系统架构

### 1.1 模块结构

```
体力系统 (Realistic Stamina System)
├── 常量定义 (SCR_StaminaConstants.c)
├── 消耗计算 (SCR_StaminaConsumption.c)
├── 恢复计算 (SCR_StaminaRecovery.c)
├── 核心系统 (SCR_RealisticStaminaSystem.c)
├── 更新协调 (SCR_StaminaUpdateCoordinator.c)
├── 速度计算 (SCR_SpeedCalculation.c)
├── 环境因子 (SCR_EnvironmentFactor.c)
├── 疲劳系统 (SCR_FatigueSystem.c)
└── 运动跟踪 (SCR_ExerciseTracking.c)
```

### 1.2 更新周期

- **更新频率**: 每0.2秒执行一次
- **更新流程**: 速度计算 → 消耗率计算 → 恢复率计算 → 净值计算 → 速度更新

---

## 二、决策树

### 2.1 主流程决策树

> **注意**: Givoni-Goldman 跑步模型已在最新版本弃用，
> 以下图示仅保留历史决策路径供阅读参考。生产环境及优化器
> 均仅使用 Pandolf 模型。


```mermaid
graph TD
    A[开始: 每0.2秒更新] --> B[速度计算]
    B --> C{是否在游泳?}
    C -->|是| D[使用游泳模型]
    C -->|否| E[使用陆地模型]
    
    E --> F{速度 > 2.2 m/s?}
    F -->|是| G[Givoni-Goldman跑步模型<br/>(已弃用，仅历史)]
    F -->|否| H[Pandolf步行模型]
    
    G --> I[应用地形系数]
    H --> I
    I --> J[应用风阻]
    J --> K[应用坡度影响]
    
    K --> L[计算基础消耗率]
    L --> M[应用姿态修正]
    M --> N[应用效率因子]
    N --> O[应用疲劳因子]
    O --> P[应用Sprint倍数]
    
    P --> Q[计算恢复率]
    Q --> R{是否在EPOC延迟期?}
    R -->|是| S[计算EPOC消耗]
    R -->|否| T[计算多维度恢复]
    
    T --> U[应用热应激惩罚]
    U --> V[应用冷应激惩罚]
    V --> W[应用地表湿度惩罚]
    W --> X[应用边际效应衰减]
    
    S --> Y[计算净值: 恢复率 - 消耗率]
    X --> Y
    
    Y --> Z[应用疲劳上限限制]
    Z --> AA[更新体力值]
    AA --> AB[计算速度倍数]
    AB --> AC[应用速度限制]
    AC --> AD[结束]
```

### 2.2 消耗率计算决策树

```mermaid
graph TD
    A[开始计算消耗率] --> B{当前速度 < 0.1 m/s?}
    B -->|是| C[静态站立消耗]
    B -->|否| D{速度 > 2.2 m/s?}
    
    D -->|是| E[Givoni-Goldman跑步模型<br/>(已弃用，仅历史)]
    D -->|否| F[Pandolf步行模型]
    
    C --> G[计算Pandolf静态项]
    G --> H[应用冷应激惩罚]
    
    E --> I[计算跑步能量消耗]
    I --> J[应用地形系数]
    J --> K[应用风阻]
    
    F --> L[计算Pandolf能量消耗]
    L --> M[应用地形系数]
    M --> N[应用风阻]
    N --> O[应用Santee下坡修正]
    
    H --> P[转换为体力消耗率]
    K --> P
    O --> P
    
    P --> Q[应用姿态修正]
    Q --> R[应用效率因子]
    R --> S[应用疲劳因子]
    S --> T[应用Sprint倍数]
    T --> U[返回消耗率]

```

### 2.3 恢复率计算决策树

```mermaid
graph TD
    A[开始计算恢复率] --> B{是否在EPOC延迟期?}
    B -->|是| C[返回0并改为EPOC消耗]
    B -->|否| D[计算多维度基础恢复率]
    
    D --> E[应用体力非线性修正]
    E --> F[应用健康状态倍数]
    F --> G{休息时间阶段}
    
    G -->|<=0.4分钟| H[快速恢复期: 1.6x]
    G -->|<=5.0分钟| I[中等恢复期: 1.3x]
    G -->|>=10分钟| J[慢速恢复期: 0.6x]
    G -->|其他| K[标准恢复期: 1.0x]
    
    H --> L[应用年龄倍数]
    I --> L
    J --> L
    K --> L
    
    L --> M[应用疲劳恢复倍数]
    M --> N{当前姿态}
    N -->|站立| O[站姿恢复: 1.3x]
    N -->|蹲姿| P[蹲姿恢复: 1.4x]
    N -->|趴姿| Q[趴姿恢复: 1.6x]
    
    O --> R[应用负重惩罚]
    P --> R
    Q --> R
    
    R --> S{体力 > 80%?}
    S -->|是| T[应用边际效应衰减]
    S -->|否| U[跳过]
    
    T --> V[应用热应激惩罚]
    U --> V
    V --> W[应用冷应激惩罚]
    W --> X[应用地表湿度惩罚-趴姿]
    X --> Y[按速度状态削减恢复]
    Y --> Z{体力 < 2%?}
    Z -->|是| AA[绝境呼吸保护: 至少0.0001]
    Z -->|否| AB[进入静态修正]
    AA --> AB
    AB --> AC{静止且恢复过低?}
    AC -->|是| AD[静态保护: 至少0.0001]
    AC -->|否| AE[返回恢复率]
    AD --> AE
```

### 2.4 速度计算决策树

```mermaid
graph TD
    A[开始计算速度倍数] --> B{体力 >= 25%?}
    B -->|是| C[意志力平台期: 保持目标速度]
    B -->|否| D{体力 >= 5%?}
    
    D -->|是| E[平滑过渡期]
    D -->|否| F[生理崩溃期]
    
    E --> G[计算smoothstep过渡]
    G --> H[在目标速度和跛行速度间插值]
    
    F --> I[计算崩溃因子]
    I --> J[速度 = 跛行速度 × 崩溃因子]
    
    C --> K[计算坡度自适应速度]
    H --> K
    J --> K
    
    K --> L[应用负重速度惩罚]
    L --> M{移动类型}
    
    M -->|Sprint| N[Sprint速度 = Run × 1.3]
    M -->|Run| O[Run速度 = 基础速度]
    M -->|Walk| P[Walk速度 = 基础速度 × 0.8]
    M -->|Idle| Q[Idle速度 = 0]
    
    N --> R[应用速度限制]
    O --> R
    P --> R
    Q --> R
    
    R --> S[返回最终速度倍数]
```

### 2.5 环境因子决策树

```mermaid
graph TD
    A[开始环境因子更新] --> B{是否在室内?}
    B -->|是| C[室内: 允许温度计算但坡度为0]
    B -->|否| D[继续]
    
    C --> D
    D --> E{温度来源?}
    E -->|引擎温度| F[按Min/Max插值并物理步进]
    E -->|物理/模拟| G[物理平衡+步进]
    
    F --> H[得到当前气温]
    G --> H
    
    H --> I{气温 > 26°C?}
    I -->|是| J["热应激倍数=1.0+(气温-26)*0.02"]
    I -->|否| K[热应激倍数 = 1.0]
    
    J --> L{是否在下雨?}
    K --> L
    
    L -->|是| M[计算降雨湿重]
    L -->|否| N[湿重衰减]
    
    M --> O["湿重 += 基础速率 * 降雨强度^指数 * dt"]
    N --> P["湿重 -= 湿重 / 持续时间 * dt"]
    
    O --> Q{风速 > 阈值?}
    P --> Q
    
    Q -->|是| R["计算风阻-仅逆风"]
    Q -->|否| S["风阻 = 0"]
    
    R --> T{泥泞度 > 阈值?}
    S --> T
    
    T -->|是| U[计算泥泞惩罚与滑倒风险]
    T -->|否| V[泥泞惩罚 = 0]
    
    U --> W{气温 < 冷应激阈值?}
    V --> W
    
    W -->|是| X[冷应激恢复惩罚与静态惩罚]
    W -->|否| Y[冷应激惩罚 = 0]
    
    X --> Z{地表湿度 > 阈值且趴姿?}
    Y --> Z
    
    Z -->|是| AA[地表湿度惩罚]
    Z -->|否| AB[地表湿度惩罚 = 0]
    
    AA --> AC[返回所有环境因子]
    AB --> AC
```

**温度模型说明**
当前稳定版模组气温采用统一模拟算法，无论是否使用引擎天气都由同一套逻辑生成，
仅根据配置决定输入数据来源。核心流程如下：

1. **输入参数**：
   - TOD、降雨强度、风速、日出/日落、纬度、日期等（由引擎或外部数据提供）
2. **昼夜曲线**
   - 先估算当天平均温度 和 日夜幅度；
   - 峰值时间约为日落前 4 小时；
   - 使用升温和降温两段曲线（sin/cos 组合）计算基础温度。
3. **雨风修正**
   - 降雨降低温度 ~6.5°C×雨强；
   - 风速微弱冷却约0.12°C/m·s⁻¹。

下面的 C 伪代码展示了此过程的具体实现：

```c
#include <stdio.h>
#include <math.h>

typedef struct {
    float tod;   // 12.0075
    float rain;  // 0
    float wind;  // 5.3249
    float sr;    // 5.8828
    float ss;    // 20.0625
    float lat;   // 47.685
    int month;   // 8
    int day;     // 14
} RSS_Data;

float SimulateTemperature(RSS_Data data) {
    // 1. 根据纬度和季节推算日温差范围
    // 8月14日属于北半球夏季
    float lat_factor = cosf(data.lat * 3.1415f / 180.0f); // 纬度越高基础分越低
    float season_factor = sinf(((data.month - 4) / 12.0f) * 3.1415f); // 8月接近夏季峰值
    
    float t_avg = 15.0f + (15.0f * lat_factor) + (5.0f * season_factor);
    float t_range = 8.0f + (4.0f * season_factor); // 夏季昼夜温差大
    
    float t_max = t_avg + (t_range / 2.0f);
    float t_min = t_avg - (t_range / 2.0f);

    // 2. 计算气温峰值时间 (通常在日落前 4 小时左右)
    float t_peak = data.ss - 4.0f; 
    if (t_peak < 12.0f) t_peak = 15.0f; // 兜底

    float current_t;

    // 3. 计算当前时刻的基础波动
    if (data.tod >= data.sr && data.tod <= t_peak) {
        // 升温阶段：日出 -> 下午3-4点
        float p = (data.tod - data.sr) / (t_peak - data.sr);
        current_t = t_min + (t_max - t_min) * powf(sinf(p * 1.5707f), 1.2f); 
    } else {
        // 降温阶段：下午4点 -> 次日日出
        float p;
        if (data.tod > t_peak) 
            p = (data.tod - t_peak) / (24.0f - t_peak + data.sr);
        else 
            p = (data.tod + 24.0f - t_peak) / (24.0f - t_peak + data.sr);
        
        current_t = t_min + (t_max - t_min) * cosf(p * 1.5707f);
    }

    // 4. 叠加降雨和风速修正
    current_t -= (data.rain * 6.5f);  // 雨水冷却
    current_t -= (data.wind * 0.12f); // 风力对环境温度的微弱修正

    return current_t;
}

int main() {
    RSS_Data engine = {12.0075f, 0.0f, 5.3249f, 5.8828f, 20.0625f, 47.685f, 8, 14};
    
    float temp = SimulateTemperature(engine);
    printf("Current Environment Temp: %.2f C\n", temp);
    
    return 0;
}
```

该逻辑用于文中前述决策树中的“按Min/Max插值并物理步进”与“物理平衡+步进”两条分支。

物理步进（`StepTemperature` 的运行）会对上一次计算出的模拟温度进行微小修正：

- **短波/长波辐射平衡**：根据太阳位置、云量计算实际入射能量。
- **潜热损失**：考虑地表湿度、降雨引起的蒸发冷却。
- **风混合效果**：风速改变近地混合层高度，影响温度响应速度。

这一步骤并不改变温度的整体趋势，而是在每个 `m_fTempUpdateInterval` 间隔内动态调整缓存温度，使其更贴近物理平衡；因此它主要影响的是 **温度随时间的变化速率** 和 **在雨/风剧烈变化时的平滑过渡**。如果禁用物理步进，系统会一直使用简单曲线给出的值，忽略这些短时的环境扰动。

---

## 三、核心公式
**参数说明**:

---

## 三、核心公式
**参数说明**:
- `E`: 能量消耗率 (W)
- `M`: 总重量倍数 = (体重 + 负重) / 参考体重 (90kg)
- `V`: 速度 (m/s)
- `G`: 坡度百分比 (例如 5% = 0.05)
- `η`: 地形系数 (1.0-1.8)
- `windDrag`: 风阻系数 (0.0-1.0)

**体力消耗率转换**:
```
staminaDrainRate = E × ENERGY_TO_STAMINA_COEFF
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L852-L921](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L852-L921)

---

### 3.2 Givoni-Goldman跑步模型（*已作废，现由Pandolf模型替代*）

> 历史上本系统使用Givoni-Goldman公式计算跑步/冲刺消耗，
> 自 v3.12.0 起所有移动消耗统一由Pandolf能量模型计算，
> 以下内容仅供参考。

**公式**:
```
E_run = M × GIVONI_CONSTANT × V^α
```

**参数说明**:
- `E_run`: 跑步能量消耗率 (W)
- `M`: 总重量倍数
- `GIVONI_CONSTANT`: 跑步常数 = 0.8
- `V`: 速度 (m/s)
- `α`: 速度指数 = 2.2

**体力消耗率转换**:
```
runningDrainRate = E_run × ENERGY_TO_STAMINA_COEFF
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L1147-L1177](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L1147-L1177)

---

### 3.3 静态站立消耗

**Pandolf静态项公式**:
```
E_standing = 1.2×W_body + 1.6×(W_body + L)×(L/W_body)²
```

**参数说明**:
- `E_standing`: 静态能量消耗率 (W)
- `W_body`: 身体重量 (90kg)
- `L`: 负重 (kg)

**体力消耗率转换**:
```
staticDrainRate = E_standing × ENERGY_TO_STAMINA_COEFF
```

**说明**: 当前实现使用更低的静态系数 (1.2/1.6)，用于降低站立静态消耗。

---

### 3.4 体力→速度映射（双稳态模型）

**分段函数**:

```python
if staminaPercent >= 0.25:  # 体力 ≥ 25%
    speedMultiplier = TARGET_RUN_SPEED_MULTIPLIER  # 0.7115 (3.7 m/s)
    
elif staminaPercent >= 0.05:  # 5% ≤ 体力 < 25%
    t = (staminaPercent - 0.05) / (0.25 - 0.05)  # 0.0-1.0
    smoothT = t² × (3 - 2t)  # smoothstep函数
    speedMultiplier = MIN_LIMP_SPEED_MULTIPLIER + 
                     (TARGET_RUN_SPEED_MULTIPLIER - MIN_LIMP_SPEED_MULTIPLIER) × smoothT
    
else:  # 体力 < 5%
    collapseFactor = staminaPercent / 0.05  # 0.0-1.0
    speedMultiplier = MIN_LIMP_SPEED_MULTIPLIER × collapseFactor
    speedMultiplier = max(speedMultiplier, MIN_LIMP_SPEED_MULTIPLIER × 0.8)

speedMultiplier = max(speedMultiplier, MIN_SPEED_MULTIPLIER)
speedMultiplier = min(speedMultiplier, MAX_SPEED_MULTIPLIER)
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L124-L169](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L124-L169)

---

### 3.5 负重速度惩罚

**公式**:
```
有效负重 = max(当前重量 - 基准重量, 0.0)
体重百分比 = 有效负重 / 角色体重
速度惩罚 = ENCUMBRANCE_SPEED_PENALTY_COEFF × 体重百分比
速度惩罚 = clamp(速度惩罚, 0.0, 0.5)  # 最多减少50%速度
```

**示例计算**:
- 30kg负重 (有效负重 = 28.64kg, 体重百分比 = 0.318)
- 速度惩罚 = 0.20 × 0.318 = 0.064 (减少6.4%速度)

**文件位置**: [SCR_RealisticStaminaSystem.c#L300-L332](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L300-L332)

---

### 3.6 负重体力消耗倍数

**公式**:
```
有效负重 = max(当前重量 - 基准重量, 0.0)
体重百分比 = 有效负重 / 角色体重
消耗倍数 = 1.0 + ENCUMBRANCE_STAMINA_DRAIN_COEFF × 体重百分比
消耗倍数 = clamp(消耗倍数, 1.0, 3.0)  # 最多3倍消耗
```

**示例计算**:
- 30kg负重 (体重百分比 = 0.318)
- 消耗倍数 = 1.0 + 2.0 × 0.318 = 1.636倍 (增加63.6%消耗)

**文件位置**: [SCR_RealisticStaminaSystem.c#L644-L679](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L644-L679)

---

### 3.7 多维度恢复率

**基础恢复率**:
```
体力恢复倍数 = 1.0 + RECOVERY_NONLINEAR_COEFF × (1.0 - 体力百分比)
基础恢复率 = BASE_RECOVERY_RATE × 体力恢复倍数
```

**综合恢复率**:
```
综合恢复率 = 基础恢复率 
            × 健康状态倍数 
            × 休息时间倍数 
            × 年龄倍数 
            × 疲劳恢复倍数 
            × 姿态恢复倍数 
            × 边际效应衰减 
            - 负重惩罚
```

**各因子计算**:

```python
# 健康状态倍数
健康状态倍数 = 1.0 + FITNESS_RECOVERY_COEFF × FITNESS_LEVEL
健康状态倍数 = clamp(健康状态倍数, 1.0, 1.5)

# 休息时间倍数
if 休息时间 <= 0.4分钟:
    休息时间倍数 = FAST_RECOVERY_MULTIPLIER  # 1.6x
elif 休息时间 <= 5.0分钟:
    休息时间倍数 = MEDIUM_RECOVERY_MULTIPLIER  # 1.3x
elif 休息时间 >= 10分钟:
    休息时间倍数 = SLOW_RECOVERY_MULTIPLIER  # 0.6x
else:
    休息时间倍数 = 1.0

# 年龄倍数
年龄倍数 = 1.0 + AGE_RECOVERY_COEFF × (AGE_REFERENCE - 角色年龄) / AGE_REFERENCE
年龄倍数 = clamp(年龄倍数, 0.8, 1.2)

# 疲劳恢复倍数
疲劳恢复惩罚 = FATIGUE_RECOVERY_PENALTY × min(运动时间 / FATIGUE_RECOVERY_DURATION, 1.0)
疲劳恢复倍数 = 1.0 - 疲劳恢复惩罚
疲劳恢复倍数 = clamp(疲劳恢复倍数, 0.7, 1.0)

# 姿态恢复倍数
if 姿态 == 站立:
    姿态恢复倍数 = STANDING_RECOVERY_MULTIPLIER  # 1.3x
elif 姿态 == 蹲姿:
    姿态恢复倍数 = CROUCHING_RECOVERY_MULTIPLIER  # 1.4x
elif 姿态 == 趴姿:
    姿态恢复倍数 = PRONE_RECOVERY_MULTIPLIER  # 1.6x

# 负重惩罚
负重比例 = 当前重量 / BODY_TOLERANCE_BASE
负重比例 = clamp(负重比例, 0.0, 2.0)
负重惩罚 = (负重比例)^LOAD_RECOVERY_PENALTY_EXPONENT × LOAD_RECOVERY_PENALTY_COEFF

# 边际效应衰减
if 体力百分比 > MARGINAL_DECAY_THRESHOLD:  # 80%
    边际衰减倍数 = MARGINAL_DECAY_COEFF - 体力百分比
    边际衰减倍数 = clamp(边际衰减倍数, 0.2, 1.0)
else:
    边际衰减倍数 = 1.0

# 速度状态削减
if 速度 >= 5.0:
    速度恢复倍数 = 0.1
elif 速度 >= 3.2:
    速度恢复倍数 = 0.3
elif 速度 >= 0.1:
    速度恢复倍数 = 0.8
else:
    速度恢复倍数 = 1.0

# 绝境呼吸保护
if 体力百分比 < 0.02:
    恢复率 = max(恢复率, 0.0001)

# 静态消耗处理（仅在静止时扣除）
if baseDrainRateByVelocity > 0 and 速度 < 0.1:
    恢复率 = max(恢复率 - baseDrainRateByVelocity, 0.00005)

# 静态保护
if 速度 < 0.1 and 当前重量 < 40.0 and 恢复率 < 0.00005:
    恢复率 = 0.0001
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L425-L553](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L425-L553)

---

### 3.8 代谢净值计算

**公式**:
```
tickScale = clamp(timeDeltaSeconds / 0.2, 0.01, 2.0)
netChange = (recoveryRate - totalDrainRate) × tickScale
newTargetStamina = currentStamina + netChange
newTargetStamina = clamp(newTargetStamina, 0.0, maxStaminaCap)
```

**EPOC延迟期间**:
```
if isInEpocDelay:
    epocDrainRate = EPOC_DRAIN_RATE × (1.0 + 停止前速度比率 × 0.5)
    totalDrainRate = totalDrainRate + epocDrainRate
```

**文件位置**: [SCR_StaminaUpdateCoordinator.c#L330-L464](f\scripts\Game\Components\Stamina\SCR_StaminaUpdateCoordinator.c#L330-L464)

---

### 3.9 热应激与温度补偿

#### 3.9.1 热应激倍数

**当前气温**:
```
当前气温 = 引擎温度插值或物理平衡温度
```

**热应激倍数**:
```
if 当前气温 > 26.0°C:
    热应激倍数 = 1.0 + (当前气温 - 26.0) × 0.02
    if 在室内:
        热应激倍数 = 热应激倍数 × (1.0 - ENV_HEAT_STRESS_INDOOR_REDUCTION)  # × 0.5
else:
    热应激倍数 = 1.0

热应激倍数 = clamp(热应激倍数, 1.0, ENV_HEAT_STRESS_MAX_MULTIPLIER)  # 1.0-1.5
```

#### 3.9.2 温度/风速对能耗补偿

从 vX.X.X 开始，体力消耗计算在获取基础机械功率后会调用环境模块对其进行补偿，
公式在两个舒适阈值之间线性，而在极端寒冷时采用平方响应：

```
float AdjustEnergyForTemperature(float T_ambient, float wind, float basePower) {
    float T_eff = T_ambient - 1.35 * sqrt(wind);
    float extra = 0.0;
    const float T_low = 18.0;
    const float T_high = 27.0;
    if (T_eff < T_low) {
        float dt = T_low - T_eff;
        extra = 0.15 * (dt * dt);
    } else if (T_eff > T_high) {
        extra = 2.0 * (T_eff - T_high);
    }
    return basePower + extra;
}
```

* `T_eff` 为风冷体感温度，风速越高体感越低。
* 低于 18°C 时消耗随温差平方增加（模拟颤抖产热）。
* 高于 27°C 时消耗线性增加（模拟排汗/心血管负担）。

此补偿在 `SCR_StaminaConsumption.CalculateStaminaConsumption` 中应
用于 `baseDrainRateByVelocity` 计算结果，随后再应用姿态/效率等修正。

**文件位置**: [SCR_EnvironmentFactor.c#L2220-L2255](f\scripts\Game\Components\Stamina\SCR_EnvironmentFactor.c#L2220-L2255)  
**消费逻辑位置**: [SCR_StaminaConsumption.c#LXXX](f\scripts\Game\Components\Stamina\SCR_StaminaConsumption.c#L100-L120)

---

### 3.10 降雨湿重计算

**湿重增加**:
```
if 在室外且正在下雨:
    湿重增加速率 = ENV_RAIN_INTENSITY_ACCUMULATION_BASE_RATE × 
                   降雨强度^ENV_RAIN_INTENSITY_ACCUMULATION_EXPONENT
    湿重 = clamp(湿重 + 湿重增加速率 × dt, 0.0, ENV_MAX_TOTAL_WET_WEIGHT)
```

**湿重衰减**:
```
else:
    湿重衰减速率 = 湿重 / ENV_RAIN_WEIGHT_DURATION
    湿重 = max(湿重 - 湿重衰减速率 × dt, 0.0)
```

**文件位置**: [SCR_EnvironmentFactor.c#L895-L941](f\scripts\Game\Components\Stamina\SCR_EnvironmentFactor.c#L895-L941)

---

### 3.11 风阻计算

**公式**:
```
if 风速 > ENV_WIND_SPEED_THRESHOLD:
    玩家速度向量 = (玩家速度[0], 0, 玩家速度[2])  # 水平分量
    if 玩家速度 > 0.1:
        风向向量 = (sin(风向×π/180), 0, cos(风向×π/180))
        风投影 = dot(玩家速度向量.归一化(), 风向向量)
        
        if 风投影 < 0:  # 逆风
            风阻 = abs(风投影) × 风速 × ENV_WIND_RESISTANCE_COEFF
            风阻 = clamp(风阻, 0.0, 1.0)
        else:
            风阻 = 0.0  # 顺风
    else:
        风阻 = 0.0
else:
    风阻 = 0.0
```

**文件位置**: [SCR_EnvironmentFactor.c#L823-L852](f\scripts\Game\Components\Stamina\SCR_EnvironmentFactor.c#L823-L852)

---

### 3.12 游泳体力消耗（3D模型）

**总功率公式**:
```
P_total = P_static + P_horizontal + P_vertical + P_survival
```

**静态功率**:
```
if 有效负重 > SWIMMING_ENCUMBRANCE_THRESHOLD:  # 25kg
    loadFactor = (有效负重 - 25kg) / (SWIMMING_FULL_PENALTY_WEIGHT - 25kg)
    loadFactor = clamp(loadFactor, 0.0, 1.0)
    P_static = SWIMMING_BASE_POWER × (1.0 + loadFactor² × (SWIMMING_STATIC_DRAIN_MULTIPLIER - 1.0))
else:
    P_static = SWIMMING_BASE_POWER
```

**水平阻力功率**:
```
if vH > SWIMMING_MIN_SPEED:
    vTotal = sqrt(vH² + vY²)
    vTotal³ = vTotal × vTotal × vTotal
    P_horizontal = 0.5 × SWIMMING_WATER_DENSITY × vTotal³ × 
                  SWIMMING_DRAG_COEFFICIENT × SWIMMING_FRONTAL_AREA × 
                  SWIMMING_DYNAMIC_POWER_EFFICIENCY
else:
    P_horizontal = 0.0
```

**垂直功率**:
```
if abs(vY) > SWIMMING_VERTICAL_SPEED_THRESHOLD:
    vY³ = abs(vY) × abs(vY) × abs(vY)
    P_vertical_drag = 0.5 × SWIMMING_WATER_DENSITY × vY³ × 
                     SWIMMING_VERTICAL_DRAG_COEFFICIENT × SWIMMING_VERTICAL_FRONTAL_AREA
    
    if vY > 0:  # 上浮
        P_vertical = ((身体重量×9.81×SWIMMING_VERTICAL_UP_BASE_BODY_FORCE_COEFF + 
                     有效负重×9.81×SWIMMING_EFFECTIVE_GRAVITY_COEFF) × vY + 
                     P_vertical_drag) × SWIMMING_VERTICAL_UP_MULTIPLIER
    else:  # 下潜
        浮力 = 身体重量×9.81×SWIMMING_BUOYANCY_FORCE_COEFF
        负重抵消 = min(有效负重×9.81×SWIMMING_VERTICAL_DOWN_LOAD_RELIEF_COEFF, 浮力)
        P_vertical = ((浮力 - 负重抵消) × abs(vY) + P_vertical_drag) × 
                    SWIMMING_VERTICAL_DOWN_MULTIPLIER
else:
    P_vertical = 0.0
```

**体力消耗率**:
```
swimmingDrainRate = P_total × SWIMMING_ENERGY_TO_STAMINA_COEFF
swimmingDrainRate = clamp(swimmingDrainRate, 0.0, SWIMMING_MAX_DRAIN_RATE)
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L1282-L1377](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L1282-L1377)

---

### 3.13 疲劳积累计算

**疲劳积累**:
```
if 超出消耗 > 0.0:
    疲劳增加 = 超出消耗 × FATIGUE_CONVERSION_COEFF
    疲劳积累 = clamp(疲劳积累 + 疲劳增加, 0.0, MAX_FATIGUE_PENALTY)
```

**疲劳恢复**:
```
if 静止且休息时间 >= FATIGUE_DECAY_MIN_REST_TIME:
    疲劳减少 = FATIGUE_DECAY_RATE × (时间增量 / 0.2)
    疲劳积累 = max(疲劳积累 - 疲劳减少, 0.0)
```

**最大体力上限**:
```
maxStaminaCap = 1.0 - 疲劳积累
```

**文件位置**: [SCR_FatigueSystem.c#L26-L93](f\scripts\Game\Components\Stamina\SCR_FatigueSystem.c#L26-L93)

---

### 3.14 坡度修正

**上坡**:
```
if 坡度角度 > 0:
    normalizedGrade = 坡度角度 / 100.0
    gradePower = normalizedGrade^1.2
    kGrade = 1.0 + gradePower × 5.0
    kGrade = min(kGrade, 3.0)
```

**下坡（缓坡）**:
```
elif 坡度角度 < 0 and abs(坡度角度) <= 15:
    kGrade = 1.0 + 坡度角度 × GRADE_DOWNHILL_COEFF
    kGrade = max(kGrade, 0.5)
```

**下坡（陡坡）**:
```
elif 坡度角度 < 0 and abs(坡度角度) > 15:
    steepGradePenalty = (abs(坡度角度) - 15.0) × 0.02
    kGrade = 1.0 + steepGradePenalty
    kGrade = min(kGrade, 1.5)
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L779-L825](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L779-L825)

---

### 3.15 Santee下坡修正

**公式**:
```
if 坡度百分比 < 0 and abs(坡度百分比) > 15:
    correctionTerm = abs(坡度百分比) × (1.0 - abs(坡度百分比) / 15.0) / 2.0
    correctionFactor = 1.0 - correctionTerm
    correctionFactor = clamp(correctionFactor, 0.5, 1.0)
    坡度项 = 坡度项 / correctionFactor  # 下坡陡坡时消耗增加
else:
    correctionFactor = 1.0
```

**文件位置**: [SCR_RealisticStaminaSystem.c#L1110-L1131](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c#L1110-L1131)

---

### 3.16 坡度-速度模型（托布勒徒步函数）

坡度对**目标速度**的影响采用 Tobler's Hiking Function (1993)，用于实现坡度-速度负反馈：上坡时自动降低目标速度以维持心肺负荷。

**公式**:
```
W(km/h) = 6 · e^(-3.5 · |S + 0.05|)
toblerMultiplier = W / TOBLER_W_AT_FLAT_KMH   # 以平地 (S=0) 为 1.0
slopeAdjustedTargetSpeed = baseTargetSpeed × max(toblerMultiplier, 0.15)
```

其中 `S = tan(θ)`，θ 为坡度角度（度）；`TOBLER_W_AT_FLAT_KMH = 5.039`（6·e^(-0.175)）。

**设计说明**:
- **公式形状**：保留 Tobler 原始曲线——上坡和陡下坡均会减速，符合生理学
- **归一化基准**：以平地 (S=0) 为 1.0，使 0 kg 平地下 Sprint 能达到引擎最大速度 5.2 m/s；若以 Tobler 峰值 (6 km/h) 为基准，平地仅约 84%
- **陡坡下限**：乘数最低 0.15，避免极端坡度导致速度过慢

**文件位置**: [SCR_RealisticStaminaSystem.c](f\scripts\Game\Components\Stamina\SCR_RealisticStaminaSystem.c) - `CalculateSlopeAdjustedTargetSpeed`

---

## 四、数值分类

### 4.1 硬编码常量

以下常量在代码中硬编码，无法通过配置文件修改：

#### 4.1.1 游戏配置常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `GAME_MAX_SPEED` | 5.2 m/s | 游戏最大速度 | [SCR_StaminaConstants.c#L9](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L9) |
| `CHARACTER_WEIGHT` | 90.0 kg | 角色体重 | [SCR_StaminaConstants.c#L109](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L109) |
| `CHARACTER_AGE` | 22.0 岁 | 角色年龄 | [SCR_StaminaConstants.c#L113](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L113) |
| `BASE_WEIGHT` | 1.36 kg | 基准负重（基本装备） | [SCR_StaminaConstants.c#L232](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L232) |
| `MAX_ENCUMBRANCE_WEIGHT` | 40.5 kg | 最大负重 | [SCR_StaminaConstants.c#L235](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L235) |
| `COMBAT_ENCUMBRANCE_WEIGHT` | 30.0 kg | 战斗负重阈值 | [SCR_StaminaConstants.c#L238](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L238) |

#### 4.1.2 速度阈值常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `SPRINT_VELOCITY_THRESHOLD` | 5.2 m/s | Sprint速度阈值 | [SCR_StaminaConstants.c#L16](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L16) |
| `RUN_VELOCITY_THRESHOLD` | 3.7 m/s | Run速度阈值 | [SCR_StaminaConstants.c#L17](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L17) |
| `WALK_VELOCITY_THRESHOLD` | 3.2 m/s | Walk速度阈值 | [SCR_StaminaConstants.c#L18](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L18) |
| `RECOVERY_THRESHOLD_NO_LOAD` | 2.5 m/s | 空载恢复阈值 | [SCR_StaminaConstants.c#L21](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L21) |
| `DRAIN_THRESHOLD_COMBAT_LOAD` | 1.5 m/s | 30kg负重消耗阈值 | [SCR_StaminaConstants.c#L22](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L22) |

#### 4.1.3 体力阈值常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `INITIAL_STAMINA_AFTER_ACFT` | 1.0 (100%) | 初始体力 | [SCR_StaminaConstants.c#L41](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L41) |
| `EXHAUSTION_THRESHOLD` | 0.0 (0%) | 精疲力尽阈值 | [SCR_StaminaConstants.c#L44](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L44) |
| `EXHAUSTION_LIMP_SPEED` | 1.0 m/s | 基础跛行速度（作为动态计算的下限；实际速度随负重降低） | [SCR_StaminaConstants.c#L45](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L45) |
| `SPRINT_ENABLE_THRESHOLD` | 0.20 (20%) | Sprint最低体力要求 | [SCR_StaminaConstants.c#L46](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L46) |
| `MIN_RECOVERY_STAMINA_THRESHOLD` | 0.2 (20%) | 最低恢复体力阈值 | [SCR_StaminaConstants.c#L212](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L212) |
| `MIN_RECOVERY_REST_TIME_SECONDS` | 3.0 秒 | 最低体力时需要的休息时间 | [SCR_StaminaConstants.c#L213](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L213) |

#### 4.1.4 体力消耗率常量 *(已作废)*

> **注意**：从 v3.12.0 开始，行走/跑步/冲刺的基础消耗率不再由这些简单常量决定，
> 而是完全由 Pandolf 能量消耗公式计算。本表仅保留以兼容旧版本和工具链。

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `SPRINT_BASE_DRAIN_RATE` | 0.480 pts/s | （已作废）Sprint基础消耗率 | [SCR_StaminaConstants.c#L27](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L27) |
| `RUN_BASE_DRAIN_RATE` | 0.075 pts/s | （已作废）Run基础消耗率 | [SCR_StaminaConstants.c#L28](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L28) |
| `WALK_BASE_DRAIN_RATE` | 0.045 pts/s | （已作废）Walk基础消耗率 | [SCR_StaminaConstants.c#L29](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L29) |
| `REST_RECOVERY_RATE` | 0.250 pts/s | Rest恢复率 | [SCR_StaminaConstants.c#L30](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L30) |

#### 4.1.5 姿态消耗倍数常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `POSTURE_STAND_MULTIPLIER` | 1.0x | 站姿消耗倍数 | [SCR_StaminaConstants.c#L340](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L340) |
| `POSTURE_CROUCH_MULTIPLIER` | 1.8x | 蹲姿消耗倍数 | [SCR_StaminaConstants.c#L338](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L338) |
| `POSTURE_PRONE_MULTIPLIER` | 3.0x | 趴姿消耗倍数 | [SCR_StaminaConstants.c#L339](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L339) |

#### 4.1.6 Pandolf模型常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `PANDOLF_BASE_COEFF` | 2.7 | 基础系数 (W/kg) | [SCR_StaminaConstants.c#L292](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L292) |
| `PANDOLF_VELOCITY_COEFF` | 3.2 | 速度系数 (W/kg) | [SCR_StaminaConstants.c#L293](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L293) |
| `PANDOLF_VELOCITY_OFFSET` | 0.7 | 速度偏移 (m/s) | [SCR_StaminaConstants.c#L294](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L294) |
| `PANDOLF_GRADE_BASE_COEFF` | 0.23 | 坡度基础系数 (W/kg) | [SCR_StaminaConstants.c#L295](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L295) |
| `PANDOLF_GRADE_VELOCITY_COEFF` | 1.34 | 坡度速度系数 (W/kg) | [SCR_StaminaConstants.c#L296](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L296) |
| `PANDOLF_STATIC_COEFF_1` | 1.2 | 静态基础系数 (W/kg) | [SCR_StaminaConstants.c#L299](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L299) |
| `PANDOLF_STATIC_COEFF_2` | 1.6 | 静态负重系数 (W/kg) | [SCR_StaminaConstants.c#L300](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L300) |
| `REFERENCE_WEIGHT` | 90.0 kg | 参考体重 | [SCR_StaminaConstants.c#L307](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L307) |

#### 4.1.7 Givoni-Goldman模型常量 *(遗留，可忽略)*

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `GIVONI_CONSTANT` | 0.8 | 跑步常数 (W/kg·m²/s²) | [SCR_StaminaConstants.c#L310](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L310) |
| `GIVONI_VELOCITY_EXPONENT` | 2.2 | 速度指数 | [SCR_StaminaConstants.c#L311](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L311) |

#### 4.1.8 地形系数常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `TERRAIN_FACTOR_PAVED` | 1.0 | 铺装路面 | [SCR_StaminaConstants.c#L314](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L314) |
| `TERRAIN_FACTOR_DIRT` | 1.1 | 碎石路 | [SCR_StaminaConstants.c#L315](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L315) |
| `TERRAIN_FACTOR_GRASS` | 1.2 | 高草丛 | [SCR_StaminaConstants.c#L316](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L316) |
| `TERRAIN_FACTOR_BRUSH` | 1.5 | 重度灌木丛 | [SCR_StaminaConstants.c#L317](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L317) |
| `TERRAIN_FACTOR_SAND` | 1.8 | 软沙地 | [SCR_StaminaConstants.c#L318](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L318) |

#### 4.1.9 恢复相关常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `RECOVERY_STARTUP_DELAY_SECONDS` | 3.0 秒 | 恢复启动延迟 | [SCR_StaminaConstants.c#L326](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L326) |
| `EPOC_DELAY_SECONDS` | 0.5 秒 | EPOC延迟时间 | [SCR_StaminaConstants.c#L332](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L332) |
| `EPOC_DRAIN_RATE` | 0.001/0.2s | EPOC期间基础消耗率 | [SCR_StaminaConstants.c#L333](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L333) |

#### 4.1.10 健康状态常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `FITNESS_LEVEL` | 1.0 | 健康状态（训练有素） | [SCR_StaminaConstants.c#L120](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L120) |
| `FITNESS_EFFICIENCY_COEFF` | 0.35 | 能量效率系数 | [SCR_StaminaConstants.c#L125](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L125) |
| `FITNESS_RECOVERY_COEFF` | 0.25 | 恢复速度系数 | [SCR_StaminaConstants.c#L129](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L129) |

#### 4.1.11 坡度相关常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `SLOPE_UPHILL_COEFF` | 0.08 | 上坡影响系数 | [SCR_StaminaConstants.c#L269](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L269) |
| `SLOPE_DOWNHILL_COEFF` | 0.03 | 下坡影响系数 | [SCR_StaminaConstants.c#L270](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L270) |
| `SLOPE_MAX_MULTIPLIER` | 2.0 | 最大坡度影响倍数 | [SCR_StaminaConstants.c#L271](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L271) |
| `SLOPE_MIN_MULTIPLIER` | 0.7 | 最小坡度影响倍数 | [SCR_StaminaConstants.c#L272](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L272) |

#### 4.1.12 Sprint相关常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `SPRINT_SPEED_BOOST` | 0.30 (30%) | Sprint速度加成 | [SCR_StaminaConstants.c#L282](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L282) |
| `SPRINT_MAX_SPEED_MULTIPLIER` | 1.0 | Sprint最高速度倍数 | [SCR_StaminaConstants.c#L285](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L285) |

#### 4.1.13 速度平滑过渡常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `TARGET_RUN_SPEED` | 3.7 m/s | 目标Run速度 | [SCR_StaminaConstants.c#L60](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L60) |
| `TARGET_RUN_SPEED_MULTIPLIER` | 0.7115 | 目标Run速度倍数 | [SCR_StaminaConstants.c#L61](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L61) |
| `WILLPOWER_THRESHOLD` | 0.25 (25%) | 意志力平台期阈值 | [SCR_StaminaConstants.c#L65](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L65) |
| `SMOOTH_TRANSITION_START` | 0.25 (25%) | 平滑过渡起点 | [SCR_StaminaConstants.c#L70](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L70) |
| `SMOOTH_TRANSITION_END` | 0.05 (5%) | 平滑过渡终点 | [SCR_StaminaConstants.c#L71](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L71) |
| `MIN_LIMP_SPEED_MULTIPLIER` | 0.1923 | 跛行速度倍数 | [SCR_StaminaConstants.c#L74](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L74) |
| `MIN_SPEED_MULTIPLIER` | 0.15 | 最小速度倍数 | [SCR_StaminaConstants.c#L100](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L100) |
| `MAX_SPEED_MULTIPLIER` | 1.0 | 最大速度倍数 | [SCR_StaminaConstants.c#L103](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L103) |

#### 4.1.14 体力指数常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `STAMINA_EXPONENT` | 0.6 | 体力影响指数 | [SCR_StaminaConstants.c#L86](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L86) |

#### 4.1.15 负重相关常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `ENCUMBRANCE_SPEED_PENALTY_COEFF` | 0.20 | 速度惩罚系数 | [SCR_StaminaConstants.c#L91](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L91) |
| `ENCUMBRANCE_SPEED_EXPONENT` | 1.5 | 负重速度惩罚指数 | [SCR_StaminaConstants.c#L92](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L92) |
| `ENCUMBRANCE_SLOPE_INTERACTION_COEFF` | 0.15 | 负重×坡度交互系数 | [SCR_StaminaConstants.c#L275](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L275) |
| `SPEED_ENCUMBRANCE_SLOPE_INTERACTION_COEFF` | 0.10 | 速度×负重×坡度交互系数 | [SCR_StaminaConstants.c#L278](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L278) |
| `BODY_TOLERANCE_BASE` | 90.0 kg | 身体耐受基准 | [SCR_StaminaConstants.c#L196](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L196) |

#### 4.1.16 恢复模型常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `RECOVERY_NONLINEAR_COEFF` | 0.5 | 恢复非线性系数 | [SCR_StaminaConstants.c#L143](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L143) |
| `FAST_RECOVERY_DURATION_MINUTES` | 0.4 min | 快速恢复期持续时间 | [SCR_StaminaConstants.c#L149](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L149) |
| `FAST_RECOVERY_MULTIPLIER` | 1.6x | 快速恢复期倍数 | [SCR_StaminaConstants.c#L150](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L150) |
| `MEDIUM_RECOVERY_START_MINUTES` | 0.4 min | 中等恢复期开始时间 | [SCR_StaminaConstants.c#L154](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L154) |
| `MEDIUM_RECOVERY_DURATION_MINUTES` | 5.0 min | 中等恢复期持续时间 | [SCR_StaminaConstants.c#L156](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L156) |
| `MEDIUM_RECOVERY_MULTIPLIER` | 1.3x | 中等恢复期倍数 | [SCR_StaminaConstants.c#L157](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L157) |
| `SLOW_RECOVERY_START_MINUTES` | 10.0 min | 慢速恢复期开始时间 | [SCR_StaminaConstants.c#L162](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L162) |
| `SLOW_RECOVERY_MULTIPLIER` | 0.6x | 慢速恢复期倍数 | [SCR_StaminaConstants.c#L163](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L163) |

#### 4.1.17 年龄相关常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `AGE_RECOVERY_COEFF` | 0.2 | 年龄恢复系数 | [SCR_StaminaConstants.c#L166](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L166) |
| `AGE_REFERENCE` | 30.0 岁 | 年龄参考值 | [SCR_StaminaConstants.c#L167](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L167) |

#### 4.1.18 疲劳相关常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `FATIGUE_RECOVERY_PENALTY` | 0.05 | 疲劳恢复惩罚系数 | [SCR_StaminaConstants.c#L171](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L171) |
| `FATIGUE_RECOVERY_DURATION_MINUTES` | 20.0 min | 疲劳完全恢复所需时间 | [SCR_StaminaConstants.c#L172](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L172) |

#### 4.1.19 姿态恢复倍数常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `STANDING_RECOVERY_MULTIPLIER` | 1.3x | 站姿恢复倍数 | [SCR_StaminaConstants.c#L182](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L182) |
| `CROUCHING_RECOVERY_MULTIPLIER` | 1.4x | 蹲姿恢复倍数 | [SCR_StaminaConstants.c#L183](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L183) |
| `PRONE_RECOVERY_MULTIPLIER` | 1.6x | 趴姿恢复倍数 | [SCR_StaminaConstants.c#L184](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L184) |

#### 4.1.20 边际效应衰减常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `MARGINAL_DECAY_THRESHOLD` | 0.8 (80%) | 边际效应衰减阈值 | [SCR_StaminaConstants.c#L203](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L203) |
| `MARGINAL_DECAY_COEFF` | 1.1 | 边际效应衰减系数 | [SCR_StaminaConstants.c#L204](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L204) |

#### 4.1.21 代谢适应常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `AEROBIC_THRESHOLD` | 0.6 | 有氧阈值 | [SCR_StaminaConstants.c#L224](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L224) |
| `ANAEROBIC_THRESHOLD` | 0.8 | 无氧阈值 | [SCR_StaminaConstants.c#L225](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L225) |
| `AEROBIC_EFFICIENCY_FACTOR` | 0.9 | 有氧区效率因子 | [SCR_StaminaConstants.c#L226](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L226) |
| `MIXED_EFFICIENCY_FACTOR` | 1.0 | 混合区效率因子 | [SCR_StaminaConstants.c#L227](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L227) |
| `ANAEROBIC_EFFICIENCY_FACTOR` | 1.2 | 无氧区效率因子 | [SCR_StaminaConstants.c#L228](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L228) |

#### 4.1.22 动作消耗常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `JUMP_STAMINA_BASE_COST` | 0.035 (3.5%) | 跳跃基础消耗 | [SCR_StaminaConstants.c#L244](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L244) |
| `VAULT_STAMINA_START_COST` | 0.02 (2%) | 翻越起始消耗 | [SCR_StaminaConstants.c#L247](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L247) |
| `CLIMB_STAMINA_TICK_COST` | 0.01 (1%/s) | 持续攀爬消耗 | [SCR_StaminaConstants.c#L250](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L250) |
| `JUMP_MIN_STAMINA_THRESHOLD` | 0.10 (10%) | 跳跃最低体力阈值 | [SCR_StaminaConstants.c#L253](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L253) |
| `JUMP_CONSECUTIVE_WINDOW` | 2.0 秒 | 连续跳跃时间窗口 | [SCR_StaminaConstants.c#L256](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L256) |
| `JUMP_CONSECUTIVE_PENALTY` | 0.5 (50%) | 连续跳跃惩罚系数 | [SCR_StaminaConstants.c#L259](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L259) |
| `JUMP_VERTICAL_VELOCITY_THRESHOLD` | 2.0 m/s | 跳跃检测阈值 | [SCR_StaminaConstants.c#L262](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L262) |
| `VAULT_VERTICAL_VELOCITY_THRESHOLD` | 1.5 m/s | 翻越检测阈值 | [SCR_StaminaConstants.c#L265](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L265) |

#### 4.1.23 游泳模型常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `SWIMMING_DRAG_COEFFICIENT` | 0.5 | 阻力系数 | [SCR_StaminaConstants.c#L350](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L350) |
| `SWIMMING_WATER_DENSITY` | 1000.0 kg/m³ | 水密度 | [SCR_StaminaConstants.c#L351](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L351) |
| `SWIMMING_FRONTAL_AREA` | 0.5 m² | 正面面积 | [SCR_StaminaConstants.c#L352](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L352) |
| `SWIMMING_BASE_POWER` | 20.0 W | 基础游泳功率 | [SCR_StaminaConstants.c#L353](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L353) |
| `SWIMMING_ENCUMBRANCE_THRESHOLD` | 25.0 kg | 负重阈值 | [SCR_StaminaConstants.c#L356](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L356) |
| `SWIMMING_STATIC_DRAIN_MULTIPLIER` | 3.0 | 静态消耗倍数 | [SCR_StaminaConstants.c#L357](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L357) |
| `SWIMMING_FULL_PENALTY_WEIGHT` | 40.0 kg | 满额惩罚重量 | [SCR_StaminaConstants.c#L358](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L358) |
| `SWIMMING_LOW_INTENSITY_DISCOUNT` | 0.7 | 低强度折扣 | [SCR_StaminaConstants.c#L359](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L359) |
| `SWIMMING_LOW_INTENSITY_VELOCITY` | 0.2 m/s | 低强度速度阈值 | [SCR_StaminaConstants.c#L360](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L360) |
| `SWIMMING_ENERGY_TO_STAMINA_COEFF` | 0.00005 | 游泳转换系数 | [SCR_StaminaConstants.c#L364](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L364) |
| `SWIMMING_DYNAMIC_POWER_EFFICIENCY` | 2.0 | 动态功率效率因子 | [SCR_StaminaConstants.c#L365](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L365) |
| `SWIMMING_VERTICAL_DRAG_COEFFICIENT` | 1.2 | 垂直方向阻力系数 | [SCR_StaminaConstants.c#L368](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L368) |
| `SWIMMING_VERTICAL_FRONTAL_AREA` | 0.8 m² | 垂直方向受力面积 | [SCR_StaminaConstants.c#L369](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L369) |
| `SWIMMING_VERTICAL_SPEED_THRESHOLD` | 0.05 m/s | 垂直速度阈值 | [SCR_StaminaConstants.c#L370](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L370) |
| `SWIMMING_EFFECTIVE_GRAVITY_COEFF` | 0.15 | 有效重力系数 | [SCR_StaminaConstants.c#L371](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L371) |
| `SWIMMING_BUOYANCY_FORCE_COEFF` | 0.10 | 浮力对抗系数 | [SCR_StaminaConstants.c#L372](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L372) |
| `SWIMMING_VERTICAL_UP_MULTIPLIER` | 2.5 | 上浮效率惩罚倍数 | [SCR_StaminaConstants.c#L373](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L373) |
| `SWIMMING_VERTICAL_DOWN_MULTIPLIER` | 1.5 | 下潜效率惩罚倍数 | [SCR_StaminaConstants.c#L374](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L374) |
| `SWIMMING_MAX_DRAIN_RATE` | 0.15 | 最大消耗率 | [SCR_StaminaConstants.c#L375](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L375) |
| `SWIMMING_VERTICAL_UP_BASE_BODY_FORCE_COEFF` | 0.02 | 上浮基础费力系数 | [SCR_StaminaConstants.c#L380](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L380) |
| `SWIMMING_VERTICAL_DOWN_LOAD_RELIEF_COEFF` | 0.50 | 负重抵消比例 | [SCR_StaminaConstants.c#L381](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L381) |
| `SWIMMING_SURVIVAL_STRESS_POWER` | 15.0 W | 生存压力常数 | [SCR_StaminaConstants.c#L384](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L384) |
| `SWIMMING_MAX_TOTAL_POWER` | 2000.0 W | 生理功率上限 | [SCR_StaminaConstants.c#L387](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L387) |
| `WET_WEIGHT_DURATION` | 30.0 秒 | 湿重持续时间 | [SCR_StaminaConstants.c#L390](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L390) |
| `WET_WEIGHT_MIN` | 5.0 kg | 最小湿重 | [SCR_StaminaConstants.c#L391](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L391) |
| `WET_WEIGHT_MAX` | 10.0 kg | 最大湿重 | [SCR_StaminaConstants.c#L392](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L392) |
| `SWIMMING_MIN_SPEED` | 0.1 m/s | 游泳最小速度 | [SCR_StaminaConstants.c#L395](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L395) |
| `SWIMMING_VERTICAL_VELOCITY_THRESHOLD` | -0.5 m/s | 垂直速度阈值 | [SCR_StaminaConstants.c#L396](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L396) |

#### 4.1.24 环境因子常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `ENV_HEAT_STRESS_START_HOUR` | 10.0 | 热应激开始时间 | [SCR_StaminaConstants.c#L400](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L400) |
| `ENV_HEAT_STRESS_PEAK_HOUR` | 14.0 | 热应激峰值时间 | [SCR_StaminaConstants.c#L401](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L401) |
| `ENV_HEAT_STRESS_END_HOUR` | 18.0 | 热应激结束时间 | [SCR_StaminaConstants.c#L402](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L402) |
| `ENV_HEAT_STRESS_MAX_MULTIPLIER` | 1.5 | 热应激最大倍数 | [SCR_StaminaConstants.c#L403](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L403) |
| `ENV_HEAT_STRESS_BASE_MULTIPLIER` | 1.0 | 热应激基础倍数 | [SCR_StaminaConstants.c#L404](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L404) |
| `ENV_HEAT_STRESS_INDOOR_REDUCTION` | 0.5 | 室内热应激减少比例 | [SCR_StaminaConstants.c#L405](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L405) |
| `ENV_RAIN_WEIGHT_MIN` | 2.0 kg | 小雨时的湿重 | [SCR_StaminaConstants.c#L408](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L408) |
| `ENV_RAIN_WEIGHT_MAX` | 8.0 kg | 暴雨时的湿重 | [SCR_StaminaConstants.c#L409](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L409) |
| `ENV_RAIN_WEIGHT_DURATION` | 60.0 秒 | 湿重持续时间 | [SCR_StaminaConstants.c#L410](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L410) |
| `ENV_RAIN_WEIGHT_DECAY_RATE` | 0.0167 | 每秒衰减率 | [SCR_StaminaConstants.c#L411](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L411) |
| `ENV_MAX_TOTAL_WET_WEIGHT` | 10.0 kg | 总湿重上限 | [SCR_StaminaConstants.c#L414](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L414) |
| `ENV_CHECK_INTERVAL` | 5.0 秒 | 环境因子检测间隔 | [SCR_StaminaConstants.c#L417](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L417) |
| `ENV_INDOOR_CHECK_HEIGHT` | 10.0 米 | 室内检测高度 | [SCR_StaminaConstants.c#L420](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L420) |
| `ENV_RAIN_INTENSITY_ACCUMULATION_BASE_RATE` | 0.5 | 基础湿重增加速率 | [SCR_StaminaConstants.c#L425](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L425) |
| `ENV_RAIN_INTENSITY_ACCUMULATION_EXPONENT` | 1.5 | 降雨强度指数 | [SCR_StaminaConstants.c#L426](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L426) |
| `ENV_RAIN_INTENSITY_THRESHOLD` | 0.01 | 降雨强度阈值 | [SCR_StaminaConstants.c#L427](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L427) |
| `ENV_RAIN_INTENSITY_HEAVY_THRESHOLD` | 0.8 | 暴雨阈值 | [SCR_StaminaConstants.c#L428](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L428) |
| `ENV_RAIN_INTENSITY_BREATHING_PENALTY` | 0.05 | 暴雨呼吸阻力惩罚 | [SCR_StaminaConstants.c#L429](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L429) |
| `ENV_WIND_RESISTANCE_COEFF` | 0.05 | 风阻系数 | [SCR_StaminaConstants.c#L432](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L432) |
| `ENV_WIND_SPEED_THRESHOLD` | 1.0 m/s | 风速阈值 | [SCR_StaminaConstants.c#L433](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L433) |
| `ENV_WIND_TAILWIND_BONUS` | 0.02 | 顺风消耗减少比例 | [SCR_StaminaConstants.c#L434](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L434) |
| `ENV_WIND_TAILWIND_SPEED_BONUS` | 0.01 | 顺风速度加成比例 | [SCR_StaminaConstants.c#L435](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L435) |
| `ENV_MUD_PENALTY_MAX` | 0.4 | 最大泥泞惩罚 | [SCR_StaminaConstants.c#L438](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L438) |
| `ENV_MUD_SLIPPERY_THRESHOLD` | 0.3 | 积水阈值 | [SCR_StaminaConstants.c#L439](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L439) |
| `ENV_MUD_SPRINT_PENALTY` | 0.1 | 泥泞Sprint速度惩罚 | [SCR_StaminaConstants.c#L440](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L440) |
| `ENV_MUD_SLIP_RISK_BASE` | 0.001 | 基础滑倒风险 | [SCR_StaminaConstants.c#L441](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L441) |
| `ENV_TEMPERATURE_HEAT_THRESHOLD` | 30.0 °C | 热应激阈值 | [SCR_StaminaConstants.c#L444](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L444) |
| `ENV_TEMPERATURE_HEAT_PENALTY_COEFF` | 0.02 | 每高1度恢复率降低比例 | [SCR_StaminaConstants.c#L445](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L445) |
| `ENV_TEMPERATURE_COLD_THRESHOLD` | 0.0 °C | 冷应激阈值 | [SCR_StaminaConstants.c#L446](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L446) |
| `ENV_TEMPERATURE_COLD_STATIC_PENALTY` | 0.03 | 低温静态消耗增加比例 | [SCR_StaminaConstants.c#L447](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L447) |
| `ENV_TEMPERATURE_COLD_RECOVERY_PENALTY` | 0.05 | 低温恢复率降低比例 | [SCR_StaminaConstants.c#L448](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L448) |
| `ENV_SURFACE_WETNESS_SOAK_RATE` | 1.0 | 趴下湿重增加速率 | [SCR_StaminaConstants.c#L451](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L451) |
| `ENV_SURFACE_WETNESS_THRESHOLD` | 0.1 | 积水阈值 | [SCR_StaminaConstants.c#L452](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L452) |
| `ENV_SURFACE_WETNESS_MARGINAL_DECAY_ADVANCE` | 0.1 | 边际效应衰减提前比例 | [SCR_StaminaConstants.c#L453](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L453) |
| `ENV_SURFACE_WETNESS_PRONE_PENALTY` | 0.15 | 湿地趴下恢复惩罚 | [SCR_StaminaConstants.c#L454](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L454) |

#### 4.1.25 姿态转换成本常量

| 常量名 | 数值 | 说明 | 文件位置 |
|--------|------|------|----------|
| `STANCE_COST_PRONE_TO_STAND` | 0.015 (1.5%) | 趴到站消耗 | [SCR_StaminaConstants.c#L813](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L813) |
| `STANCE_COST_PRONE_TO_CROUCH` | 0.010 (1.0%) | 趴到蹲消耗 | [SCR_StaminaConstants.c#L814](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L814) |
| `STANCE_COST_CROUCH_TO_STAND` | 0.005 (0.5%) | 蹲到站消耗 | [SCR_StaminaConstants.c#L815](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L815) |
| `STANCE_COST_STAND_TO_PRONE` | 0.003 (0.3%) | 站到趴消耗 | [SCR_StaminaConstants.c#L816](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L816) |
| `STANCE_COST_OTHER` | 0.003 (0.3%) | 其他转换消耗 | [SCR_StaminaConstants.c#L817](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L817) |
| `STANCE_FATIGUE_ACCUMULATION` | 1.0 | 疲劳堆积增加量 | [SCR_StaminaConstants.c#L826](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L826) |
| `STANCE_FATIGUE_DECAY` | 0.3 | 疲劳堆积衰减速率 | [SCR_StaminaConstants.c#L829](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L829) |
| `STANCE_FATIGUE_MAX` | 10.0 | 最大疲劳堆积值 | [SCR_StaminaConstants.c#L832](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L832) |
| `STANCE_WEIGHT_BASE` | 90.0 kg | 负重基准重量 | [SCR_StaminaConstants.c#L840](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L840) |
| `STANCE_TRANSITION_MIN_STAMINA_THRESHOLD` | 0.10 (10%) | 姿态转换最低体力阈值 | [SCR_StaminaConstants.c#L847](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L847) |

---

### 4.2 动态配置值

以下数值从配置管理器（SCR_RSS_ConfigManager）动态获取，可以通过配置文件修改：

#### 4.2.1 基础恢复率

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `base_recovery_rate` | 0.00035/0.2s | 基础恢复率（每0.2秒） | [GetBaseRecoveryRate()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L472-L482) |

#### 4.2.2 能量到体力转换系数

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `energy_to_stamina_coeff` | 0.000035 | 能量→体力转换系数 | [GetEnergyToStaminaCoeff()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L459-L469) |

#### 4.2.3 姿态恢复倍数

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `standing_recovery_multiplier` | 1.5x | 站姿恢复倍数 | [GetStandingRecoveryMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L485-L495) |
| `prone_recovery_multiplier` | 1.8x | 趴姿恢复倍数 | [GetProneRecoveryMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L498-L508) |

#### 4.2.4 负重恢复惩罚

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `load_recovery_penalty_coeff` | 0.0004 | 负重恢复惩罚系数 | [GetLoadRecoveryPenaltyCoeff()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L511-L521) |
| `load_recovery_penalty_exponent` | 2.0 | 负重恢复惩罚指数 | [GetLoadRecoveryPenaltyExponent()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L524-L534) |

#### 4.2.5 负重速度惩罚

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `encumbrance_speed_penalty_coeff` | 0.20 | 负重速度惩罚系数 | [GetEncumbranceSpeedPenaltyCoeff()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L537-L547) |

#### 4.2.6 负重体力消耗

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `encumbrance_stamina_drain_coeff` | 1.5 | 负重体力消耗系数 | [GetEncumbranceStaminaDrainCoeff()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L550-L560) |

#### 4.2.7 Sprint消耗倍数

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `sprint_stamina_drain_multiplier` | 3.0 | Sprint体力消耗倍数 | [GetSprintStaminaDrainMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L563-L573) |

#### 4.2.8 疲劳积累参数

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `fatigue_accumulation_coeff` | 0.015 | 疲劳累积系数 | [GetFatigueAccumulationCoeff()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L576-L586) |
| `fatigue_max_factor` | 2.0 | 最大疲劳因子 | [GetFatigueMaxFactor()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L589-L599) |

#### 4.2.9 姿态消耗倍数

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `posture_crouch_multiplier` | 2.0x | 蹲姿消耗倍数 | [GetPostureCrouchMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L603-L613) |
| `posture_prone_multiplier` | 2.5x | 趴姿消耗倍数 | [GetPostureProneMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L617-L627) |

#### 4.2.10 Custom预设配置

以下配置仅在 `Custom` 预设下生效：

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `m_fStaminaDrainMultiplier` | 1.0 | 体力消耗倍率 | [GetStaminaDrainMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L678-L685) |
| `m_fStaminaRecoveryMultiplier` | 1.0 | 体力恢复倍率 | [GetStaminaRecoveryMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L688-L695) |
| `m_fEncumbranceSpeedPenaltyMultiplier` | 1.0 | 负重速度惩罚倍率 | [GetEncumbranceSpeedPenaltyMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L698-L705) |
| `m_fSprintSpeedMultiplier` | 1.3 | Sprint速度倍率 | [GetSprintSpeedMultiplier()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L708-L715) |

#### 4.2.11 系统开关配置

以下配置仅在 `Custom` 预设下生效，用于控制各子系统：

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `m_bEnableHeatStress` | true | 启用热应激系统 | [IsHeatStressEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L718-L725) |
| `m_bEnableRainWeight` | true | 启用降雨湿重系统 | [IsRainWeightEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L728-L735) |
| `m_bEnableWindResistance` | true | 启用风阻系统 | [IsWindResistanceEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L738-L745) |
| `m_bEnableMudPenalty` | true | 启用泥泞惩罚系统 | [IsMudPenaltyEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L748-L755) |
| `m_bEnableFatigueSystem` | true | 启用疲劳积累系统 | [IsFatigueSystemEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L758-L765) |
| `m_bEnableMetabolicAdaptation` | true | 启用代谢适应系统 | [IsMetabolicAdaptationEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L768-L775) |
| `m_bEnableIndoorDetection` | true | 启用室内检测系统 | [IsIndoorDetectionEnabled()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L778-L785) |

#### 4.2.12 更新间隔配置

| 配置参数 | 默认值 | 说明 | 获取方法 |
|---------|--------|------|----------|
| `m_iTerrainUpdateInterval` | 5000 ms | 地形检测更新间隔 | [GetTerrainUpdateInterval()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L788-L795) |
| `m_iEnvironmentUpdateInterval` | 5000 ms | 环境因子更新间隔 | [GetEnvironmentUpdateInterval()](f\scripts\Game\Components\Stamina\SCR_StaminaConstants.c#L798-L805) |

---

## 附录

### A. 配置文件结构

配置文件路径：`scripts/Game/Components/Stamina/SCR_RSS_Settings.c`

```c
class SCR_RSS_Params
{
    // 基础恢复率
    float base_recovery_rate = 0.00035;
    
    // 能量到体力转换系数
    float energy_to_stamina_coeff = 0.000035;
    
    // 姿态恢复倍数
    float standing_recovery_multiplier = 1.5;
    float prone_recovery_multiplier = 1.8;
    
    // 负重恢复惩罚
    float load_recovery_penalty_coeff = 0.0004;
    float load_recovery_penalty_exponent = 2.0;
    
    // 负重速度惩罚
    float encumbrance_speed_penalty_coeff = 0.20;
    
    // 负重体力消耗
    float encumbrance_stamina_drain_coeff = 1.5;
    
    // Sprint消耗倍数
    float sprint_stamina_drain_multiplier = 3.0;
    
    // 疲劳积累参数
    float fatigue_accumulation_coeff = 0.015;
    float fatigue_max_factor = 2.0;
    
    // 姿态消耗倍数
    float posture_crouch_multiplier = 2.0;
    float posture_prone_multiplier = 2.5;
    
    // Custom预设配置
    float m_fStaminaDrainMultiplier = 1.0;
    float m_fStaminaRecoveryMultiplier = 1.0;
    float m_fEncumbranceSpeedPenaltyMultiplier = 1.0;
    float m_fSprintSpeedMultiplier = 1.3;
    
    // 系统开关
    bool m_bEnableHeatStress = true;
    bool m_bEnableRainWeight = true;
    bool m_bEnableWindResistance = true;
    bool m_bEnableMudPenalty = true;
    bool m_bEnableFatigueSystem = true;
    bool m_bEnableMetabolicAdaptation = true;
    bool m_bEnableIndoorDetection = true;
    
    // 更新间隔
    int m_iTerrainUpdateInterval = 5000;
    int m_iEnvironmentUpdateInterval = 5000;
}
```

### B. 预设系统

系统支持以下预设：

1. **EliteStandard** - 精英标准
2. **StandardMilsim** - 标准军事模拟
3. **TacticalAction** - 战术行动
4. **Custom** - 自定义（允许修改所有配置）

只有选择 `Custom` 预设时，用户的自定义配置才会被读取。其他预设使用硬编码的默认值。

### C. 调试配置

| 配置参数 | 默认值 | 说明 |
|---------|--------|------|
| `m_bDebugLogEnabled` | false | 启用调试日志 |
| `m_bVerboseLogging` | false | 启用详细日志 |
| `m_iDebugUpdateInterval` | 5000 ms | 调试信息刷新间隔 |

---

## 文档版本

- **版本**: 1.0
- **最后更新**: 2026-01-30
- **作者**: Realistic Stamina System Team

## 参考文档

- [SCR_StaminaConstants.c](scripts/Game/Components/Stamina/SCR_StaminaConstants.c)
- [SCR_StaminaConsumption.c](scripts/Game/Components/Stamina/SCR_StaminaConsumption.c)
- [SCR_StaminaRecovery.c](scripts/Game/Components/Stamina/SCR_StaminaRecovery.c)
- [SCR_RealisticStaminaSystem.c](scripts/Game/Components/Stamina/SCR_RealisticStaminaSystem.c)
- [SCR_StaminaUpdateCoordinator.c](scripts/Game/Components/Stamina/SCR_StaminaUpdateCoordinator.c)
- [SCR_SpeedCalculation.c](scripts/Game/Components/Stamina/SCR_SpeedCalculation.c)
- [SCR_EnvironmentFactor.c](scripts/Game/Components/Stamina/SCR_EnvironmentFactor.c)
- [SCR_FatigueSystem.c](scripts/Game/Components/Stamina/SCR_FatigueSystem.c)
- [SCR_ExerciseTracking.c](scripts/Game/Components/Stamina/SCR_ExerciseTracking.c)
